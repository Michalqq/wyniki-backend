"use strict";(self.webpackChunkjavascript=self.webpackChunkjavascript||[]).push([[688],{1688:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var a=n(7294),r=n(9669),l=n.n(r),i=n(496),o=n(6974),c=n(9661),s=n(6668),u=n(9942),m=n(3992),d=n(7625),f=n(1436),v=n(9952);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var p=function(e){var t=y((0,a.useState)([]),2),n=t[0],r=t[1],o=y((0,a.useState)(!0),2),s=o[0],g=o[1],p=function(){l().get("".concat((0,u.AC)(),"/penalty/getPenalties?eventId=").concat(e.eventId)).then((function(e){r(e.data),g(!1)}))};(0,a.useEffect)((function(){p()}),[]);var b=(0,a.useMemo)((function(){return[{width:"20%",id:"team",Header:"Załoga",disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(a.Fragment,null,a.createElement("div",{className:"py-1 px-2 mx-1 d-grid"},a.createElement(m.M,{value:e.row.original.number})),a.createElement("div",{className:"px-1 mx-1 d-grid"},a.createElement(c.Ur,{team:e.row.original})))}},{width:"70%",id:"penalty",Header:"Czas - Powód - OS/PS",disableFilters:!0,disableSortBy:!0,Cell:function(t){return a.createElement("table",{className:"font14"},t.row.original.penalties.map((function(t){return a.createElement(a.Fragment,null,a.createElement("tr",null,a.createElement("td",{className:"text-left fw-bolder",style:{width:"20%"}},"Taryfa"!==t.description?t.penaltySec+" s":""),a.createElement("td",{className:"text-left px-3",style:{width:"45%"}},t.description),a.createElement("td",{className:"text-left px-3",style:{width:"40%"}},t.name),a.createElement("td",{style:{width:"15%"}},e.referee?a.createElement(d.G,{icon:f.nYk,onClick:function(){return n=t.penaltyId,void l().post("".concat((0,u.AC)(),"/penalty/removePenalty?penaltyId=").concat(n),{},{headers:(0,v.Z)()}).then((function(t){e.onRemove(),p()}));var n},title:"Usuń kare"}):a.createElement(a.Fragment,null))))})))}}]}),[e.referee]);return a.createElement(i.Z,{columns:b,data:n,pageCount:3,isLoading:s,isFooter:!1,isHeader:!0,cursor:"pointer",manualPagination:!0})};function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var h=function(e){var t=b((0,a.useState)([]),2),n=t[0],r=t[1],o=b((0,a.useState)(!0),2),s=o[0],y=o[1],g=function(){l().get("".concat((0,u.AC)(),"/penalty/getDisqualifications?eventId=").concat(e.eventId)).then((function(e){r(e.data),y(!1)}))};(0,a.useEffect)((function(){g()}),[]);var p=(0,a.useMemo)((function(){return[{width:"5%",id:"nr",Header:"Nr",accessor:function(e){return e.number},disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(m.M,{value:e.value})}},{width:"20%",id:"team",Header:"Załoga",disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(c.Ur,{team:e.row.original})}},{width:"60%",id:"penalty",Header:"Powód - OS/PS",disableFilters:!0,disableSortBy:!0,Cell:function(t){return a.createElement("table",{className:"font14"},t.row.original.penalties.map((function(t){return a.createElement(a.Fragment,null,a.createElement("tr",null,a.createElement("td",{className:"text-left fw-bolder"}),a.createElement("td",{className:"text-left px-3 width-300"},t.description),a.createElement("td",{className:"text-left px-3"},t.name),a.createElement("td",null,e.referee?a.createElement(d.G,{icon:f.nYk,onClick:function(){return n=t.penaltyId,void l().post("".concat((0,u.AC)(),"/penalty/removeDisqualification?penaltyId=").concat(n),{},{headers:(0,v.Z)()}).then((function(t){y(!0),e.onRemove(),g()}));var n},title:"Wycofaj dyskwalifikacje"}):a.createElement(a.Fragment,null))))})))}}]}),[e.referee]);return a.createElement(a.Fragment,null,a.createElement(i.Z,{columns:p,data:n,pageCount:3,isLoading:s,isFooter:!1,isHeader:!0,cursor:"pointer",manualPagination:!0}))},w=n(5005),N=n(2763),S=n(7182),x=n(5509),C=n(7905),k=n(1881),O=n(6968);function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var A=function(e){var t=e.show,n=e.handleClose,r=e.eventId,i=e.markedNumbers,o=e.psOptions,s=I((0,a.useState)(!1),2),d=s[0],f=s[1],v=I((0,a.useState)([]),2),y=v[0],g=v[1],p=I((0,a.useState)([]),2),b=p[0],E=p[1];(0,a.useEffect)((function(){t&&((0,S.CE)(n),2===i.length&&(h(),(0,u.TX)(r,i,(function(e){g(e)}))))}),[t]);var h=function(){void 0!==r&&l().get("".concat((0,u.AC)(),"/event/getBasicTeams?eventId=").concat(r)).then((function(e){E(e.data)}))};return(0,a.useEffect)((function(){b.length>0&&y.length>0&&f(!1)}),[b,y]),a.createElement(a.Fragment,null,a.createElement(k.Z,{show:t,onHide:n,backdrop:"static",keyboard:!1,size:"xl"},a.createElement(k.Z.Header,{closeButton:!0,className:"bg-dark-green text-white"},a.createElement(k.Z.Title,{className:"text-white"},"Porównanie wyników")),a.createElement(k.Z.Body,{className:"my-px-3"},d?a.createElement("div",{className:"text-center"},a.createElement(O.Z,{animation:"border",variant:"secondary",size:"lg"})):2!==i.length?a.createElement("h6",{className:"text-center pt-3"},i.length<2?"Zaznacz 2 zawodników klikając na pomarańczowy numer startowy!":"Porównanie możliwe tylko dla 2 zawodników - zaznaczyłeś ".concat(i.length)):a.createElement("div",null,a.createElement("div",{className:"row pt-0 my-px-3 bg-light"},i.map((function(e){var t=b.find((function(t){return t.number===e}));return a.createElement("div",{className:"col p-1 ps-4",style:{scale:"1.1"}},t&&a.createElement("div",{className:"d-flex"},a.createElement("div",{className:"align-self-center pe-2"},a.createElement(m.M,{value:e})),a.createElement(c.Ur,{team:{driver:t.driver,coDriver:t.coDriver,club:t.club,coClub:t.coClub,teamName:t.teamName}})))}))),a.createElement("div",{className:"row pt-0 my-px-3",style:{backgroundColor:"lightgray"}},i.sort((function(e,t){return e<t?-1:1})).map((function(e){var t,n=b.find((function(t){return t.number===e})),r=null==n?void 0:n.car;return a.createElement("div",{className:"col p-3 ps-4",style:{scale:"1.1"}},n&&a.createElement(c.He,{line1:((null==r?void 0:r.brand)||"")+" "+((null==r?void 0:r.model)||""),line2:null===(t=n.carClass)||void 0===t?void 0:t.name,carBrand:null==r?void 0:r.brand,driveType:null==r?void 0:r.driveTypeEnum}))}))),a.createElement("div",{className:"row pt-1 px-3"},a.createElement("table",{className:"table table-stripe"},a.createElement("thead",{className:"thead-dark"},a.createElement("tr",null,a.createElement("th",{style:{width:"10%"}},"PS"),a.createElement("th",{style:{width:"30%"},className:"text-end"},"Załoga nr ".concat(i[0])),a.createElement("th",{style:{width:"10%"},className:"text-center"},"Różnica"),a.createElement("th",{className:"text-start"},"Załoga nr ".concat(i[1])))),a.createElement("tbody",null,o.map((function(e,t){var n,r,l,i,o=t%2==0?"bg-light-gray ":"",s=y.filter((function(t){return t.stageId===Number(e.value)})).sort((function(e,t){return e.teamNumber<t.teamNumber?-1:1})),u=(null===(n=s[0])||void 0===n?void 0:n.score)+1e3*(null===(r=s[0])||void 0===r?void 0:r.penalty),m=(null===(l=s[1])||void 0===l?void 0:l.score)+1e3*(null===(i=s[1])||void 0===i?void 0:i.penalty);return a.createElement(a.Fragment,null,a.createElement("tr",{className:o},a.createElement("th",{className:"p-1"},a.createElement("div",{style:{marginRight:"auto"}},a.createElement(c.O8,{line1:"PS "+(t+1),line2:"0"}))),2==s.length&&a.createElement(a.Fragment,null,a.createElement("th",{className:"text-end "+(u<m?"text-success":"fw-normal")},a.createElement(c.O8,{line1:(0,S.to)(s[0].score),line2:0===s[0].penalty?"0":s[0].penalty})),a.createElement("th",{className:"text-center"},a.createElement(c.AK,{line1:"",line2:"",line3:(0,S.to)(Math.abs(u-m))})),a.createElement("th",{className:u>m?"text-success":"fw-normal"},a.createElement(c.O8,{line1:(0,S.to)(s[1].score),line2:0===s[1].penalty?"0":s[1].penalty})))))}))))))),a.createElement(k.Z.Footer,{className:"justify-content-center"},a.createElement("div",{className:"d-flex"},a.createElement(w.Z,{className:"m-1",variant:"secondary",onClick:n},"Wyjdź")))))},F=n(1251);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(l.push(a.value),!t||l.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var z=function(e){var t,n=T((0,a.useState)(1),2),r=n[0],d=n[1],f=T((0,a.useState)([]),2),v=f[0],y=f[1],g=T((0,a.useState)(!1),2),b=g[0],E=g[1],k=(0,o.TH)(),O=(0,o.TH)().search,I=O.includes("&")?O.indexOf("&"):O.length,j=O.substring(0,I).replace("?",""),P=(0,o.s0)(),H=j||localStorage.getItem("eventId")||(null===(t=k.state)||void 0===t?void 0:t.eventId),B="GENERALNA",z="GOŚĆ",D=T((0,a.useState)(),2),M=D[0],R=D[1],U=T((0,a.useState)([]),2),L=U[0],G=U[1],K=T((0,a.useState)(!1),2),W=K[0],$=K[1],_=T((0,a.useState)([]),2),q=_[0],Q=_[1],V=T((0,a.useState)([]),2),Y=V[0],X=V[1],J=T((0,a.useState)([]),2),ee=J[0],te=J[1],ne=T((0,a.useState)(B),2),ae=ne[0],re=ne[1],le=T((0,a.useState)(),2),ie=le[0],oe=le[1],ce=T((0,a.useState)(""),2),se=ce[0],ue=ce[1],me=T((0,a.useState)(!0),2),de=(me[0],me[1],T((0,a.useState)(!1),2)),fe=de[0],ve=(de[1],(0,F.pA)(ie,{skip:void 0===ie})),ye=ve.data,ge=void 0===ye?[]:ye,pe=ve.isFetching,be=ve.refetch,Ee=(0,F.bz)({eventId:H,stageId:ie},{skip:void 0===ie||void 0===H}),he=Ee.data,we=void 0===he?[]:he,Ne=Ee.isFetching,Se=Ee.refetch,xe=function(){void 0!==ie&&l().get("".concat((0,u.AC)(),"/event/getBasicEvent?eventId=").concat(H)).then((function(e){R(Z(Z({},e.data),{},{date:new Date(e.data.date),signDeadline:new Date(e.data.signDeadline)}))}))};(0,a.useEffect)((function(){void 0===H&&P("/"),(0,u.Ot)(H,$)}),[]),(0,a.useEffect)((function(){xe(),G([]),Q([])}),[ie]),(0,a.useEffect)((function(){(0,u.sH)(H,(function(e){X(e.psOptions||[]),te(e.classesOptions||[])})),xe()}),[]),(0,a.useEffect)((function(){if(!pe&&0!==ge.length){var e=ae==="".concat(B,"+").concat(z)?ge:ae===B?ge.filter((function(e){return e.className!==z})):ge.filter((function(e){return e.className===ae||e.driveType===ae}));G((0,S.uG)(e))}}),[ge,ae]),(0,a.useEffect)((function(){if(!Ne&&0!==we.length){var e=ae==="".concat(B,"+").concat(z)?we:ae===B?we.filter((function(e){return e.className!==z})):we.filter((function(e){return e.className===ae||e.driveType===ae}));Q((0,S.uG)(e))}}),[we,ae]);var Ce=(0,a.useMemo)((function(){return[{width:"5%",id:"place",Header:"P.",accessor:function(e){return e.place},disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(a.Fragment,null," ",e.row.index+1)}},{width:"7%",id:"nr",Header:"Nr",accessor:function(e){return e.number},disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(m.M,{value:e.value,isBold:v.includes(e.value),onClick:function(){return ke(e.value)}})}},{width:"30%",id:"team",Header:"Załoga",disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(c.Ur,{team:e.row.original})}},{width:"30%",id:"car",Header:"Samochód",disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(c.He,{line1:e.row.original.car,line2:e.row.original.className,carBrand:e.row.original.brand,driveType:e.row.original.driveType})}},{width:"15%",id:"score",Header:"Czas / kary",accessor:function(e){return e.stageScore},disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(c.O8,{line1:e.row.original.stageScore,line2:e.row.original.totalPenalty})}},{width:"15%",id:"result",Header:"Wynik / straty",accessor:function(e){return e.stageScore},disableFilters:!0,disableSortBy:!0,Cell:function(e){return a.createElement(c.AK,{line1:e.row.original.totalTime,line2:e.row.original.timeTo,line3:e.row.original.timeToFirst})}}]}),[]),ke=function(e){v.includes(e)?v.splice(v.indexOf(e),1):v.push(e),y(Array.from(v))},Oe=function(e){if(v.includes(e.values.nr))return"#c9e9a7"};return a.createElement(a.Fragment,null,a.createElement("div",{className:"row card-body mx-0"},a.createElement("h4",null,(null==M?void 0:M.name)||""),a.createElement("div",{className:"col-xl-8 d-flex justify-content-center"},((null==M?void 0:M.logoPathFile)||(null==M?void 0:M.logoPath))&&a.createElement("div",{className:"col-6 align-self-center"},a.createElement("div",{className:"m-0 text-center"},M.logoPathFile?a.createElement("img",{id:"eventImage"+M.eventId,style:{maxHeight:"150px"},className:"img-fluid rounded float-left",src:"data:image/jpg;base64,"+M.logoPathFile,alt:"Logo"}):a.createElement("img",{style:{maxHeight:"150px"},className:"img-fluid rounded float-left",src:M.logoPath,alt:"Logo"}))),a.createElement("div",{className:"col-6"},a.createElement(s.Q,{label:"Klasyfikacja",options:ee,handleChange:function(e){re(ee.find((function(t){return t.value===e})).label)},isValid:!0}),a.createElement(s.Q,{label:"PS",options:Y,value:sessionStorage.getItem("scoreStageId"),handleChange:function(e){oe(e),ue(Y.find((function(t){return t.value===e})).label),sessionStorage.setItem("scoreStageId",e)},isValid:!0}))),a.createElement("div",{className:"col-xl-4"},a.createElement("div",{className:"m-2 text-center"},W&&a.createElement(a.Fragment,null,a.createElement(w.Z,{className:"m-1",variant:"success",onClick:function(){return P("/add_score",{state:{eventId:H}})}},"Dodaj wynik"),a.createElement(w.Z,{className:"m-1",variant:"primary",onClick:function(){return P("/add_penalty",{state:{eventId:H}})}},"Dodaj kare"),a.createElement(N.O,{variant:"secondary",isLoading:fe,onClick:function(){window.open("".concat((0,u.AC)(),"/file/getScoresFile?eventId=").concat(H),"_blank")},msg:"Generuj plik z zestawieniem wyników",loadingMsg:"Trwa generowanie\r pliku z wynikami"})),a.createElement(w.Z,{className:"m-1",variant:"primary",onClick:function(){Se(),be()}},"Odśwież"),a.createElement(w.Z,{className:"m-1",variant:"success",onClick:function(){return E(!0)}},"Porównaj wyniki")))),a.createElement("div",{className:"row pt-0 mx-0 card-body"},a.createElement("div",{className:"fw-bold alert alert-secondary p-1 mb-2",role:"alert"},"".concat(se)),a.createElement(x.Z,{activeKey:r,onSelect:function(e){return d(e)},className:"mb-1 fw-bold text-dark device-small"},a.createElement(C.Z,{eventKey:1,title:"Czas NA",className:"custom-tab"},a.createElement("div",{className:"my-pe-1"},a.createElement("div",{className:"shadow bg-body rounded"},a.createElement(i.Z,{columns:Ce,data:L,pageCount:3,isLoading:pe,isFooter:!1,isHeader:!0,cursor:"pointer",manualPagination:!0,highlightRow:function(e){return Oe(e)}})))),a.createElement(C.Z,{eventKey:2,title:"Suma PO",className:"custom-tab"},a.createElement("div",{className:"my-ps-1"},a.createElement("div",{className:"shadow bg-body rounded"},a.createElement(i.Z,{columns:Ce,data:q,pageCount:3,isLoading:Ne,isFooter:!1,isHeader:!0,cursor:"pointer",manualPagination:!0,highlightRow:function(e){return Oe(e)}}))))),a.createElement("div",{className:"col-xl-12 px-1"},a.createElement("div",{className:"shadow bg-body rounded mt-4 p-0"},a.createElement("div",{className:"fw-bold alert alert-secondary p-1 m-0",role:"alert"},"Kary"),a.createElement(p,{eventId:H,onRemove:xe,referee:W})),a.createElement("div",{className:"shadow bg-body rounded mt-4"},a.createElement("div",{className:"fw-bold alert alert-secondary p-1 m-0",role:"alert"},"Dyskwalifikacje / Wycofania"),a.createElement(h,{eventId:H,onRemove:xe,referee:W})))),b&&a.createElement(A,{show:!0,handleClose:function(){return E()},eventId:H,markedNumbers:v,psOptions:Y}))}}}]);
//# sourceMappingURL=main.d75d501a9f3adeb2e9ab.js.map